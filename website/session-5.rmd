---
title: 'Quantifying evidence'
author: 'Ben Whalley, Paul Sharpe, Sonja Heintz'
# date: "April 2021"
bibliography: [references.bib]
csl: apa.csl
#biblio-style: apa6
link-citations: yes
output:
  webex::html_clean
---

```{r, include=F, echo=F}
source('_first_chunk.R')
library(corrr)
```




```{html, child="bs-tab-fix.html"}
```


```{css, child="video.css"}
```


![](images/scales.png)


# Overview

In the [previous workshop](session-4.html) we learned techniques to describe and summarise data.
Now we take the next step quantify how *sure* we are that the patterns are real, using the *Bayes Factor*.

The Bayes Factor (BF) is a single number which allows us to choose between different *possible* hypotheses (explanations) of how our data were generated, based on which is most probable.

The important thing to remember about Bayes Factors is that they ***compare two possible hypotheses*** about how the data came about.  The ***meaning*** of the Bayes Factor completely depends on which hypotheses we compare.




# Is this pattern a fluke?



```{r, echo=F}
video_data <- list(identifier = "bayes-fluke", ytidentifier = "yt-embed")
# makermds(video_data)
```

```{r child = '_content/_video_tabs.rmd'}
```



# Do it: Bayesian t test


```{r, echo=F}
video_data <- list(identifier = "bayes-ttest", ytidentifier = "yt-embed")
# makermds(video_data)
```

```{r child = '_content/_video_tabs.rmd'}
```


:::{.exercise}

1. Open `session-5.rmd` using the **Files** pane. This is the workbook you will be using in this session.
1. Use the `funimagery` dataset
1. Plot participants' weights at baseline (`kg1`) in each intervention group
1. Use `summarise()` to calculate the difference between the groups weight
1. Use `with()` and `ttestBF()` to calculate the Bayes Factor for this difference


```{r}

funimagery %>% 
  ggplot(aes(intervention, kg1)) + geom_boxplot()

aa <- with(funimagery,  ttestBF(intervention, kg1,posterior=T, iterations=1e4)) 
aa %>% as_data_frame() %>% group_by
```


:::



# Do it: Bayes Factor for correlations

```{r, echo=F}
video_data <- list(identifier = "bayes-corr", ytidentifier = "yt-embed")
# makermds(video_data)
```

```{r child = '_content/_video_tabs.rmd'}
```



# Interpreting Bayes Factors

The size of a Bayes Factor is mostly dependent on three things:

- *How large* the effect is (how big is the group difference or how steep is the slope)
- *How clear* the difference is (e.g., how much do the scores from each group overlap)
- *How much data* we collect (more data lets us be more confident; data quality also matters)


We return to this topic later but for now just remember that:

- A Bayes Factor or 1 means each hypothesis is equally likely
- A Bayes factor > 3 is a common threshold for thinking an effect is 'real' (although this threshold is arbitrary)
- A Bayes Factor $< \frac{1}{3}$ is evidence *against* the effect being real
- If the Bayes Factor is $> \frac{1}{3}$ and $<3$ then we say the result is ***inconclusive***.



# Test your knowledge

- What hypotheses are being compared when we calculate a Bayes Factor for a correlation?
- Which function do we recommend to calculate correlation coefficients?
- Which function calculates the Bayes Factor for a correlation?
- Which function calculates the Bayes Factor for a difference in the average of two groups?
- What direction slope does a correlation of -0.5 imply? What would the scatterplot look like?
- What conclusion should we draw if the Bayes Factor for a correlation is 2.1? How about if it was 0.21, or 210?
- What conclusion should we draw if the Bayes Factor for a t test is 0.8? How about if it were > 10?


# References